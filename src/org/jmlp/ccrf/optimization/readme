compound conditional random field 
the optimization part